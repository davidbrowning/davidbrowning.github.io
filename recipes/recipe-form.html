<!DOCTYPE html>
<html>
  <head>
    <title>Recipe Creator</title>
  </head>
  <body>
    <h1>Create a Recipe</h1>
    <form id="recipe-form">
      <label>Recipe Name:</label>
      <input type="text" id="recipe-name" placeholder="Crock Pot Roast">
      <br>
      <h2>Ingredients:</h2>
      <button type="button" id="add-ingredient">Add Ingredient</button>
      <div id="ingredients"></div>
      <br>
      <h2>Instructions:</h2>
      <button type="button" id="add-instruction">Add Instruction</button>
      <div id="instructions"></div>
      <br>
      <label>Story:</label>
      <input type="text" id="story">
      <br>
      <button type="button" id="submit-recipe">Submit Recipe</button>
    </form>
    <script>
        var ingredientCount = 0;
        var instructionCount = 0;
        var ingredients = [];
        var instructions = [];
        var timers = [];
        var imageURL = "";
        var originalURL = "";

        // Add ingredient input fields
        document.getElementById("add-ingredient").addEventListener("click", function() {
            var ingredientDiv = document.getElementById("ingredients");
            var ingredient = document.createElement("div");
            ingredient.innerHTML = `
                <label>Quantity:</label>
                <input type="text" id="ingredient-quantity-${ingredientCount}">
                <label>Name:</label>
                <input type="text" id="ingredient-name-${ingredientCount}">
                <label>Type:</label>
                <input type="text" id="ingredient-type-${ingredientCount}">
            `;
            ingredientDiv.appendChild(ingredient);
            ingredientCount++;
        });

        // Add instruction input fields
        document.getElementById("add-instruction").addEventListener("click", function() {
            var instructionDiv = document.getElementById("instructions");
            var instruction = document.createElement("div");
            instruction.innerHTML = `
                <label>Step ${instructionCount + 1}:</label>
                <input type="text" id="instruction-${instructionCount}">
                <label>Timer:</label>
                <input type="text" id="timer-${instructionCount}">
            `;
            instructionDiv.appendChild(instruction);
            instructionCount++;
        });

        // Handle recipe submission
        document.getElementById("submit-recipe").addEventListener("click", function() {
            var recipeName = document.getElementById("recipe-name").value;
            var story = document.getElementById("story").value;
            for (var i = 0; i < ingredientCount; i++) {
                var ingredient = {
                    quantity: document.getElementById(`ingredient-quantity-${i}`).value,
                    name: document.getElementById(`ingredient-name-${i}`).value,
		    type: document.getElementById(`ingredient-type-${i}`).value
                };
                ingredients.push(ingredient);
            }

            for (var i = 0; i < instructionCount; i++) {
                var instruction = document.getElementById(`instruction-${i}`).value;
                var timer = document.getElementById(`timer-${i}`).value;
                instructions.push(instruction);
                timers.push(timer);
            }

            var recipe = {
                "name": recipeName,
                "ingredients": ingredients,
                "steps": instructions,
                "timers": timers,
                "story": story
            };

            // Output recipe as JSON
            console.log(JSON.stringify(recipe));
	    // Download recipe as a JSON file
            var json = JSON.stringify(recipe);
            var blob = new Blob([json], {type: "application/json"});
            var link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = recipeName + ".json";
            link.click();

            // Clear form fields
            document.getElementById("recipe-form").reset();
            ingredientCount = 0;
            instructionCount = 0;
            ingredients = [];
            instructions = [];
            timers = [];
        });
    </script>
  </body>
</html>
